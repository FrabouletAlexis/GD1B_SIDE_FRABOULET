<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Jeu montagne enneig√©e</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var config = {
    type: Phaser.AUTO,
    width: 1280,
    height: 700,
    physics: {
        default: 'arcade',
        arcade: {
            gravity: { y: 400 },
            debug: false
        }
    },
    
    input : {gamepad:true},
    scene: {
        preload: preload,
        create: create,
        update: update
    }
};
    
var platforms;
    
//Commande
var cursors;
var cursors2;
var paddle;
var padConnected;
var onGround ;
    
var position_base = true;
var saut = false;
    
// platform
var glace = false;
var neige = false;
var roche = true;
var escalade_joueur = false;

var particule_escalade;

var pique_bas = false;
var pique_haut = false;
var gouffre = false;
    
//vie
var pv_max = 3;
var pv = 1;
var coeur;
var pvText;
// vitesse joueur/////////////////
var vitesse_joueur = 330;
var vitesse_neige = 150;
var vitesse_glace = 200;
var vitesse_escalade = 300;
var vitesse_saut = 600;

var attaque = false;
    
var gameOver = false;
var gameOvertext;
    
var escalade_joueur = false;
var gravite_joueur = 600;


//var collectCoeur = false;    
var coeurX = 80;
var coeurY = 80;
    
var game = new Phaser.Game(config);
         
function preload (){
        
    this.load.image('sky', 'assets/landscape.png');
    this.load.image('ground', 'assets/platform.png');
    this.load.image('platform_neige', 'assets/platform_neige.png');
    this.load.image('platform_glace', 'assets/platform_glace.png');
    this.load.image('platform_escalade', 'assets/mur_escalade.png');
    this.load.image('platform_pique', 'assets/pique.png');
    
    this.load.image("mia_course", "assets/teste_2.png");
    this.load.spritesheet('mia_anime', 'assets/mia_anime.png', { frameWidth: 125, frameHeight: 150 });
    this.load.spritesheet('loup_anims', 'assets/loup_anims.png', { frameWidth: 138, frameHeight: 70 });
    this.load.spritesheet('mia_pose', 'assets/mia_pose.png', { frameWidth: 99/2, frameHeight: 150 });
    this.load.spritesheet('piolet', 'assets/piolet.png', { frameWidth: 64, frameHeight: 80 });
    
    this.load.image("particule","assets/particule.png");
    this.load.image("coeur","assets/batterie.png");
    this.load.image("coeur_perdu","assets/coeur_perdu.png");
    this.load.image("coeur_aquit","assets/coeur_aquit.png");
    
    this.load.image("clouds-white", "assets/clouds-white.png");
    this.load.image("clouds-white-small", "assets/clouds-white-small.png");
    
    this.load.image('tiles','assets/tiles/platform.png');
    this.load.tilemapTiledJSON('map','assets/tiles/level.json');
    
    
}

function create (){
        
    this.add  
    .text(100, 200, "Arrow keys or WASD to move & jump", {
        font: "18px monospace",
        fill: "#000000",
        padding: { x: 20, y: 10 },
        backgroundColor: "#ffffff"
      })
    .setDepth(1)
      .setScrollFactor(0);

    // background /////////////////////
    
        
    // nuage /////////////////////
    
    cloudsWhite = this.add.tileSprite(640, 200, 1280, 400, "clouds-white");
    cloudsWhiteSmall = this.add.tileSprite(640, 200, 1280, 400, "clouds-white-small");
                
    // platforms /////////////////////
    const map = this.make.tilemap({key : 'map'});
    const tileset = map.addTilesetImage('platforms','tiles');
    
    platforms = map.createDynamicLayer('roche',tileset);
    

 

}

function update (){
    cloudsWhite.tilePositionX += 0.25;
    cloudsWhiteSmall.tilePositionX += 0.10;

}


</script>

</body>
</html>